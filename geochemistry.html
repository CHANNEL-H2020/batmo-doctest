<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>geochemistry: Surface geochemistry &mdash; The Matlab Reservoir Simulation Toolbox 2019b documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="heterogeneity" href="heterogeneity.html" />
    <link rel="prev" title="fvbiot: Consistent finite-volume discretizations for poroelasticity" href="fvbiot.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> The Matlab Reservoir Simulation Toolbox
            <img src="_static/mrstlogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2019b
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-core.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-core</span></code>: Automatic Differentiation Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-props.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-props</span></code>: PVT, fluid models and other properties for the AD-solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-blackoil.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-blackoil</span></code>: Black-oil solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-eor.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-eor</span></code>: Enhanced oil recovery solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-mechanics.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-mechanics</span></code>: Coupled flow and mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="adjoint.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">adjoint</span></code>: Two-phase, incompressible adjoint solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="agglom.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">agglom</span></code>: Flow and property-based coarse-grid generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="blackoil-sequential.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">blackoil-sequential</span></code>: Sequential implicit black-oil solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="book.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">book</span></code>: Book examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="coarsegrid.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">coarsegrid</span></code>: Generation of coarse grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="compositional.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">compositional</span></code>: Equation-of-state compositional solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="co2lab.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">co2lab</span></code>: Numerical CO<sub>2</sub> laboratory</a></li>
<li class="toctree-l1"><a class="reference internal" href="deckformat.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">deckformat</span></code>: Reading and conversion of input decks</a></li>
<li class="toctree-l1"><a class="reference internal" href="dfm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dfm</span></code>: Discrete fracture matrix implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dg.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dg</span></code>: Discontinous Galerkin discretizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">diagnostics</span></code>: Flow diagnostics functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="dual_porosity.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dual-porosity</span></code>: Dual porosity/permeability model for fractures</a></li>
<li class="toctree-l1"><a class="reference internal" href="fvbiot.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">fvbiot</span></code>: Consistent finite-volume discretizations for poroelasticity</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">geochemistry</span></code>: Surface geochemistry</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#in-startup-user-m-add-the-line">4. In startup_user.m add the line</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mrstpath-register-geochemistry-path-to-repo-matlab-geochemistry">mrstPath(‘register’, ‘geochemistry’, ‘path/to/repo/matlab-geochemistry’)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mrstmodule-add-geochemistry">mrstModule add geochemistry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="heterogeneity.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">heterogeneity</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="hfm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">hfm</span></code>: Hierarchical and embedded fractures</a></li>
<li class="toctree-l1"><a class="reference internal" href="incomp.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">incomp</span></code>: Solvers for incompressible flow and transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="libgeometry.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">libgeometry</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="linearsolvers.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">linearsolvers</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab_bgl.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">matlab_bgl</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="mimetic.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mimetic</span></code>: Mimetic solvers for pressure problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpfa.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mpfa</span></code>: Multi-point flux approximation solvers for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrst_api.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mrst_api</span></code>: API for writing C/C++ for MRST</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrst-gui.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mrst-gui</span></code>: Graphical user-interfaces for MRST</a></li>
<li class="toctree-l1"><a class="reference internal" href="msfvm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msfvm</span></code>: Multiscale Finite-Volume method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="msmfem.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msmfem</span></code>: Multiscale Mixed Finite-Element method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="msrsb.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msrsb</span></code>: Multiscale Restriction-Smoothed Basis method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="nwm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">nwm</span></code>: Near Wellbore Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="opm_gridprocessing.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">opm_gridprocessing</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">optimization</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="re-mpfa.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">re-mpfa</span></code>: Richards’ equation with multi-point flux</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvent.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">solvent</span></code>: Solvent solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="spe10.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">spe10</span></code>: Access to the SPE10 benchmark case</a></li>
<li class="toctree-l1"><a class="reference internal" href="steady-state.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">steady-state</span></code> Steady-state upscaling of functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="streamlines.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">streamlines</span></code>: Compute streamlines</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangle.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">triangle</span></code>: Triangular grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="upscaling.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">upscaling</span></code>: Upscaling of reservoir problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="vem.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">vem</span></code>: Virtual element method on general grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="vemmech.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">vemmech</span></code>: Mechanics for general grids using the virtual element method</a></li>
<li class="toctree-l1"><a class="reference internal" href="wellpaths.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">wellpaths</span></code>: Generation of wells using general curves</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">The Matlab Reservoir Simulation Toolbox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref mat mat-func docutils literal notranslate"><span class="pre">geochemistry</span></code>: Surface geochemistry</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/geochemistry.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="geochemistry-surface-geochemistry">
<h1><code class="xref mat mat-func docutils literal notranslate"><span class="pre">geochemistry</span></code>: Surface geochemistry<a class="headerlink" href="#geochemistry-surface-geochemistry" title="Permalink to this headline"></a></h1>
<p># README #</p>
<p>The matlab-geoChemistry repository contains tools for the solution of equilibrium geochemical systems including aqueous and surface chemistry for use in batch and transport settings.</p>
<p>### Summary ###</p>
<p>The main function of this repository, ChemicalModel, allows the creation and solution of arbitrarily complex chemistry systems including equilibrium aqueous speciation, surface complexation, ion exchange, redox chemistry, dissolution/precipitation and equilbrium with gas phases. The function leverages the tools developed by the SINTEF [MRST team](<a class="reference external" href="http://www.sintef.no/projectweb/mrst/">http://www.sintef.no/projectweb/mrst/</a>) including [automatic differentiation](<a class="reference external" href="https://en.wikipedia.org/wiki/Automatic_differentiation">https://en.wikipedia.org/wiki/Automatic_differentiation</a>). The chemical model created can be used to calculate batch reaction or can be coupled to flow within MRST. See the user guide pdf for details on use, equations, examples, and benchmarks.</p>
<p>Models supported:</p>
<ul class="simple">
<li><p>aqueous speciation</p></li>
<li><p>aqueous activity</p></li>
<li><dl class="simple">
<dt>surface chemistry</dt><dd><ul>
<li><p>triple layer model</p></li>
<li><p>diffuse layer model</p></li>
<li><p>basic stern model</p></li>
<li><p>constant capacitance model</p></li>
<li><p>ion exchange</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>dissolution/precipitation</p></li>
<li><p>gas phase equilibrium</p></li>
</ul>
<p>### Installation ###</p>
<ol class="arabic simple">
<li><p>Install [MRST](<a class="reference external" href="http://www.mrst.no">http://www.mrst.no</a>).</p></li>
<li><p>Add the matlab-geoChemistry folder to the “modules” folder of MRST.</p></li>
<li><p>Create a file named startup_user.m within the MRST folder, at the same level as startup.m.</p></li>
</ol>
<div class="section" id="in-startup-user-m-add-the-line">
<h2>4. In startup_user.m add the line<a class="headerlink" href="#in-startup-user-m-add-the-line" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="mrstpath-register-geochemistry-path-to-repo-matlab-geochemistry">
<h2>mrstPath(‘register’, ‘geochemistry’, ‘path/to/repo/matlab-geochemistry’)<a class="headerlink" href="#mrstpath-register-geochemistry-path-to-repo-matlab-geochemistry" title="Permalink to this headline"></a></h2>
<p>### Use ###</p>
<p>Once MRST is installed and made aware of the location of matlab-geoChemistry the module can be used like any other MRST module.</p>
<p>Before any script that relies on the repository is run, MRST must be started. This is done by running the file startup.m which is loacted inside of your MRST directory.</p>
<p>To use the geochemistry module in a Matlab script include the command</p>
<div class="section" id="mrstmodule-add-geochemistry">
<h3>mrstModule add geochemistry<a class="headerlink" href="#mrstmodule-add-geochemistry" title="Permalink to this headline"></a></h3>
<p>this will make the contents of the geochemistry directory available in the workspace.</p>
<span class="target" id="module-geochemistry.utils"></span><dl class="mat function">
<dt class="sig sig-object mat" id="geochemistry.utils.changeUnits">
<span class="sig-name descname"><span class="pre">changeUnits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">states</span></em>, <em class="sig-param"><span class="pre">fields</span></em>, <em class="sig-param"><span class="pre">unit_conv</span></em><span class="sig-paren">)</span><a class="headerlink" href="#geochemistry.utils.changeUnits" title="Permalink to this definition"></a></dt>
<dd><p>changeUnits converts the specified fields in states to the specified units.</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="p">=</span> <span class="n">changeUnits</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> – <dl class="simple">
<dt>The state structure produced by ChemicalModel/initstate. State</dt><dd><p>must be populated by the named variable before they can be retrived.</p>
</dd>
<dt>fields - Name of the fields for which the unit change is to occur. Can</dt><dd><p>be a string or cell array of strings.</p>
</dd>
<dt>unit - Numeric value of unit conversion. If numel(unit) == 1 and fields</dt><dd><p>has multple entries then the one value of unit will be applied
to all fields. Otherwise if fields is a cell with multple entries
then fields and unit must have the same size,
numel(unit) == numel(fields).unit_conv = unit_conv.^-1;</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – the state variable with the fields state.fields converted from
SI units to the units specified in units</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="c">% change the units of a single fields</span>

      <span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="p">=</span> <span class="n">changeUnits</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s">&#39;activities&#39;</span><span class="p">,</span> <span class="n">mol</span><span class="o">/</span><span class="n">litre</span><span class="p">)</span>

<span class="c">%change the units of a multiple fields</span>

      <span class="n">fields</span> <span class="p">=</span> <span class="p">{</span><span class="s">&#39;acitivities&#39;</span><span class="p">,</span> <span class="s">&#39;surfaceCharges&#39;</span><span class="p">}</span>
      <span class="n">units</span> <span class="p">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">/</span><span class="n">litre</span><span class="p">,</span> <span class="n">mili</span><span class="o">*</span><span class="n">Coulumb</span><span class="o">/</span><span class="p">(</span><span class="n">nano</span><span class="o">*</span><span class="n">meter</span><span class="p">)</span>^<span class="mi">2</span><span class="p">];</span>

      <span class="n">state</span> <span class="p">=</span> <span class="n">chem</span><span class="p">.</span><span class="n">getProps</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">units</span><span class="p">);</span>

<span class="n">If</span> <span class="n">state</span> <span class="n">is</span> <span class="n">a</span> <span class="nb">cell</span> <span class="n">array</span> <span class="n">of</span> <span class="n">structures</span> <span class="n">the</span> <span class="k">function</span> <span class="n">will</span> <span class="n">loop</span> <span class="n">over</span> <span class="n">each</span> <span class="nb">cell</span><span class="p">.</span>

<span class="n">The</span> <span class="n">numeric</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">unit</span> <span class="n">conversion</span> <span class="n">must</span> <span class="n">be</span> <span class="n">defined</span><span class="p">.</span> <span class="n">There</span> <span class="n">is</span> <span class="n">a</span> <span class="n">bank</span>
<span class="n">of</span> <span class="n">unit</span> <span class="n">conversions</span> <span class="n">within</span> <span class="n">the</span> <span class="n">release</span><span class="p">.</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h4>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fvbiot.html" class="btn btn-neutral float-left" title="fvbiot: Consistent finite-volume discretizations for poroelasticity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="heterogeneity.html" class="btn btn-neutral float-right" title="heterogeneity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, SINTEF Digital.
      <span class="lastupdated">Last updated on Sep 23, 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>