<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>heterogeneity &mdash; The Matlab Reservoir Simulation Toolbox 2019b documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="hfm: Hierarchical and embedded fractures" href="hfm.html" />
    <link rel="prev" title="geochemistry: Surface geochemistry" href="geochemistry.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> The Matlab Reservoir Simulation Toolbox
            <img src="_static/mrstlogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2019b
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-core.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-core</span></code>: Automatic Differentiation Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-props.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-props</span></code>: PVT, fluid models and other properties for the AD-solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-blackoil.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-blackoil</span></code>: Black-oil solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-eor.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-eor</span></code>: Enhanced oil recovery solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-mechanics.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-mechanics</span></code>: Coupled flow and mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="adjoint.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">adjoint</span></code>: Two-phase, incompressible adjoint solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="agglom.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">agglom</span></code>: Flow and property-based coarse-grid generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="blackoil-sequential.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">blackoil-sequential</span></code>: Sequential implicit black-oil solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="book.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">book</span></code>: Book examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="coarsegrid.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">coarsegrid</span></code>: Generation of coarse grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="compositional.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">compositional</span></code>: Equation-of-state compositional solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="co2lab.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">co2lab</span></code>: Numerical CO<sub>2</sub> laboratory</a></li>
<li class="toctree-l1"><a class="reference internal" href="deckformat.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">deckformat</span></code>: Reading and conversion of input decks</a></li>
<li class="toctree-l1"><a class="reference internal" href="dfm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dfm</span></code>: Discrete fracture matrix implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dg.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dg</span></code>: Discontinous Galerkin discretizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">diagnostics</span></code>: Flow diagnostics functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="dual_porosity.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dual-porosity</span></code>: Dual porosity/permeability model for fractures</a></li>
<li class="toctree-l1"><a class="reference internal" href="fvbiot.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">fvbiot</span></code>: Consistent finite-volume discretizations for poroelasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="geochemistry.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">geochemistry</span></code>: Surface geochemistry</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">heterogeneity</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hfm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">hfm</span></code>: Hierarchical and embedded fractures</a></li>
<li class="toctree-l1"><a class="reference internal" href="incomp.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">incomp</span></code>: Solvers for incompressible flow and transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="libgeometry.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">libgeometry</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="linearsolvers.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">linearsolvers</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab_bgl.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">matlab_bgl</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="mimetic.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mimetic</span></code>: Mimetic solvers for pressure problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpfa.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mpfa</span></code>: Multi-point flux approximation solvers for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrst_api.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mrst_api</span></code>: API for writing C/C++ for MRST</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrst-gui.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mrst-gui</span></code>: Graphical user-interfaces for MRST</a></li>
<li class="toctree-l1"><a class="reference internal" href="msfvm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msfvm</span></code>: Multiscale Finite-Volume method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="msmfem.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msmfem</span></code>: Multiscale Mixed Finite-Element method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="msrsb.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msrsb</span></code>: Multiscale Restriction-Smoothed Basis method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="nwm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">nwm</span></code>: Near Wellbore Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="opm_gridprocessing.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">opm_gridprocessing</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">optimization</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="re-mpfa.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">re-mpfa</span></code>: Richards’ equation with multi-point flux</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvent.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">solvent</span></code>: Solvent solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="spe10.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">spe10</span></code>: Access to the SPE10 benchmark case</a></li>
<li class="toctree-l1"><a class="reference internal" href="steady-state.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">steady-state</span></code> Steady-state upscaling of functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="streamlines.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">streamlines</span></code>: Compute streamlines</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangle.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">triangle</span></code>: Triangular grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="upscaling.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">upscaling</span></code>: Upscaling of reservoir problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="vem.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">vem</span></code>: Virtual element method on general grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="vemmech.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">vemmech</span></code>: Mechanics for general grids using the virtual element method</a></li>
<li class="toctree-l1"><a class="reference internal" href="wellpaths.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">wellpaths</span></code>: Generation of wells using general curves</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">The Matlab Reservoir Simulation Toolbox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref mat mat-func docutils literal notranslate"><span class="pre">heterogeneity</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/heterogeneity.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-heterogeneity.utils">
<span id="heterogeneity"></span><h1><code class="xref mat mat-func docutils literal notranslate"><span class="pre">heterogeneity</span></code><a class="headerlink" href="#module-heterogeneity.utils" title="Permalink to this headline"></a></h1>
<dl class="mat function">
<dt class="sig sig-object mat" id="heterogeneity.utils.computeDTOF">
<span class="sig-name descname"><span class="pre">computeDTOF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">comp</span></em>, <em class="sig-param"><span class="pre">startCells</span></em>, <em class="sig-param"><span class="pre">cellSize</span></em><span class="sig-paren">)</span><a class="headerlink" href="#heterogeneity.utils.computeDTOF" title="Permalink to this definition"></a></dt>
<dd><p>Compute diffusive time of flight with Fast Marching Method (FMM). See
Zhang et al. 2013 (SPE 163637). The diffusive time of flight is related
to the propagation of a pressure front, similar to the depth of
investigation.</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">DTOF</span> <span class="p">=</span> <span class="n">computeDTOF</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">rock</span><span class="p">,</span><span class="n">fluid</span><span class="p">,</span><span class="n">comp</span><span class="p">,</span><span class="n">startCells</span><span class="p">,</span><span class="n">cellSize</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Cartesian or logically Cartesian grid.</p></li>
<li><p><strong>rock</strong> – Rock structure with the fields ‘poro’ and ‘perm’.</p></li>
<li><p><strong>fluid</strong> – MRST fluid structure where fluid.properties(1)=viscosity</p></li>
<li><p><strong>comp</strong> – Total compressibility. Vector of size (1,1) or (N,1)
where N is the number of grid cells.</p></li>
<li><p><strong>startCells</strong> – Cells where DTOF=0;</p></li>
<li><p><strong>cellSize</strong> – Vector of size (1,d) or (N,d) where d is dimension of the
grid and N is the number of cells.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>DTOF</strong> – Diffusive time of flight</p></li>
<li><p><strong>Written by Asgeir Nyvoll, MSc student NTNU, 2018</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="heterogeneity.utils.effPermDesc">
<span class="sig-name descname"><span class="pre">effPermDesc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">BS</span></em>, <em class="sig-param"><span class="pre">CS</span></em>, <em class="sig-param"><span class="pre">TauS2</span></em>, <em class="sig-param"><span class="pre">QS</span></em>, <em class="sig-param"><span class="pre">Ve</span></em><span class="sig-paren">)</span><a class="headerlink" href="#heterogeneity.utils.effPermDesc" title="Permalink to this definition"></a></dt>
<dd><p>Calculate effective permeability descriptors from streamline descriptors
effective bulk volume and rates</p>
<p>SYNOPSIS:
[BS, CS, TauS2]=streamtubePermDesc(GradP, LS, fluid, shortestpath);</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GradP</strong> – Pressure gradients for each substep in Pollock
approximation</p></li>
<li><p><strong>LS</strong> – Streamline length for each substep in Pollock approximation</p></li>
<li><p><strong>fluid</strong> – MRST fluid structure where fluid.properties(1) is viscosity</p></li>
<li><p><strong>shortestpath</strong> – Length of streamline if no tortuosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>BS</strong> – Streamline/streamtube hydraulic conductance</p></li>
<li><p><strong>CS</strong> – Streamline constriction factor</p></li>
<li><p><strong>TauS2</strong> – Streamline tortuosity factor</p></li>
</ul>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>[BS, CS, TauS2]=streamtubePermDesc(GradP, LS, fluid, shortestpath);</p>
<p>SEE ALSO: effPermDesc(), pollockMod()
Written by Asgeir Nyvoll, MSc student NTNU, 2018</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="heterogeneity.utils.pollockMod">
<span class="sig-name descname"><span class="pre">pollockMod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">state</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#heterogeneity.utils.pollockMod" title="Permalink to this definition"></a></dt>
<dd><p>Trace streamlines in logically Cartesian grid using Pollock approximation.
In addition to the regular Pollock approximation, pressure gradients are
supported.</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">GP</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">)</span>
<span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">GP</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">startpos</span><span class="p">)</span>
<span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">GP</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="s">&#39;pn&#39;</span><span class="p">,</span> <span class="n">pv</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">GP</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">startpos</span><span class="p">,</span> <span class="s">&#39;pn&#39;</span><span class="p">,</span> <span class="n">pv</span><span class="p">,</span> <span class="p">...)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Cartesian or logically Cartesian grid.</p></li>
<li><p><strong>state</strong> – State structure with field ‘flux’.</p></li>
<li><p><strong>rock</strong> – Rock structure with the field ‘poro’.</p></li>
</ul>
</dd>
</dl>
<p>OPTIONAL PARAMETERS</p>
<blockquote>
<div><dl>
<dt>positions - Matrix of size (N, 1) or (N, d+1), where d is the dimension</dt><dd><p>of the grid, used to indicate where the streamlines should
start.</p>
<p>If the size is (N, 1), positions contains the cell indices
in which streamlines should start. Each streamline is
started in the the local coordinate (0.5, 0.5, …). To be
precise, this is the mean of the corner points, not the
centroid of the cell.</p>
<p>If the size is (N, d+1), the first column contains cell
indices, and the d next columns contain the local
coordinates at which to start streamlines.</p>
</dd>
</dl>
</div></blockquote>
<p>OPTIONAL PARAMETERS (supplied in ‘key’/value pairs (‘pn’/pv …)):</p>
<blockquote>
<div><dl class="simple">
<dt>substeps   - Number of substeps in each cell, to improve visual quality.</dt><dd><p>Default 5.</p>
</dd>
<dt>maxsteps   - Maximal number of points in a streamline.</dt><dd><p>Default 1000.</p>
</dd>
<dt>reverse    - Reverse velocity field before tracing.</dt><dd><p>Default false.</p>
</dd>
<dt>periodic   - Grid with periodic boundary conditions.</dt><dd><p>Default not periodic boundary conditions.</p>
</dd>
<dt>fluid      - MRST fluid structure where fluid.properties(1)=viscosity</dt><dd><p>Default viscosity: 1 cP</p>
</dd>
<dt>lineLength - Method for streamline length calculation. Options:</dt><dd><p>‘straight’ (straight line between plots) and ‘integral’.
Default: ‘straight’</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> – Cell array of individual streamlines suitable for calls like
streamline(pollock(…)) and streamtube(pollock(…)).</p></li>
<li><p><strong>T</strong> – Time-of-flight of coordinate.</p></li>
<li><p><strong>C</strong> – Cell number of streamline segment, i.e, line segment between
two streamline coordinates.</p></li>
<li><p><strong>L</strong> – Streamline lengths</p></li>
<li><p><strong>V</strong> – Velocity vectors</p></li>
<li><p><strong>GP</strong> – Pressure gradients</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">GP</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span><span class="n">startpos</span><span class="p">,</span><span class="s">&#39;fluid&#39;</span><span class="p">,</span><span class="n">fluid</span><span class="p">);</span>

<span class="n">streamline</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
</pre></div>
</div>
<p>SEE ALSO: pollock()</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="heterogeneity.utils.pollockPressureTriLin">
<span class="sig-name descname"><span class="pre">pollockPressureTriLin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">state</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#heterogeneity.utils.pollockPressureTriLin" title="Permalink to this definition"></a></dt>
<dd><p>Trace streamlines in logically Cartesian grid using Pollock approximation.
In addition to the regular Pollock approximation, pressures are
supported by the use of trilinear interpolation (not recommended to use,
use pollockMod instead).</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">P</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">)</span>
<span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">P</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">startpos</span><span class="p">)</span>
<span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">P</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="s">&#39;pn&#39;</span><span class="p">,</span> <span class="n">pv</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">P</span><span class="p">]</span> <span class="p">=</span> <span class="n">pollockMod</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">startpos</span><span class="p">,</span> <span class="s">&#39;pn&#39;</span><span class="p">,</span> <span class="n">pv</span><span class="p">,</span> <span class="p">...)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Cartesian or logically Cartesian grid.</p></li>
<li><p><strong>state</strong> – State structure with field ‘flux’.</p></li>
<li><p><strong>rock</strong> – Rock structure with the field ‘poro’.</p></li>
</ul>
</dd>
</dl>
<p>OPTIONAL PARAMETERS</p>
<blockquote>
<div><dl>
<dt>positions - Matrix of size (N, 1) or (N, d+1), where d is the dimension</dt><dd><p>of the grid, used to indicate where the streamlines should
start.</p>
<p>If the size is (N, 1), positions contains the cell indices
in which streamlines should start. Each streamline is
started in the the local coordinate (0.5, 0.5, …). To be
precise, this is the mean of the corner points, not the
centroid of the cell.</p>
<p>If the size is (N, d+1), the first column contains cell
indices, and the d next columns contain the local
coordinates at which to start streamlines.</p>
</dd>
</dl>
</div></blockquote>
<p>OPTIONAL PARAMETERS (supplied in ‘key’/value pairs (‘pn’/pv …)):</p>
<blockquote>
<div><dl class="simple">
<dt>substeps   - Number of substeps in each cell, to improve visual quality.</dt><dd><p>Default 5.</p>
</dd>
<dt>maxsteps   - Maximal number of points in a streamline.</dt><dd><p>Default 1000.</p>
</dd>
<dt>reverse    - Reverse velocity field before tracing.</dt><dd><p>Default false.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> – Cell array of individual streamlines suitable for calls like
streamline(pollock(…)) and streamtube(pollock(…)).</p></li>
<li><p><strong>T</strong> – Time-of-flight of coordinate.</p></li>
<li><p><strong>C</strong> – Cell number of streamline segment, i.e, line segment between
two streamline coordinates.</p></li>
<li><p><strong>P</strong> – Interpolated pressure in each coordinate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="heterogeneity.utils.streamtubePermDesc">
<span class="sig-name descname"><span class="pre">streamtubePermDesc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">gradP</span></em>, <em class="sig-param"><span class="pre">dS</span></em>, <em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#heterogeneity.utils.streamtubePermDesc" title="Permalink to this definition"></a></dt>
<dd><p>Calculate streamline permeability descriptors from streamline gradients,
line lengths, fluid model and shortest path.</p>
<p>SYNOPSIS:
[Be,Ce,Te2,varTs2,varInvCs] = effPermDesc(BS,CS,TauS2, Qs, Ve);</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS</strong> – Streamline/streamtube hydraulic conductance</p></li>
<li><p><strong>CS</strong> – Streamline constriction factor</p></li>
<li><p><strong>TauS2</strong> – Streamline tortuosity factor</p></li>
<li><p><strong>Qs</strong> – Streamtube rate</p></li>
<li><p><strong>Ve</strong> – Effective bulk volume</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h2>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geochemistry.html" class="btn btn-neutral float-left" title="geochemistry: Surface geochemistry" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hfm.html" class="btn btn-neutral float-right" title="hfm: Hierarchical and embedded fractures" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, SINTEF Digital.
      <span class="lastupdated">Last updated on Sep 23, 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>