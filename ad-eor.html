<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ad-eor: Enhanced oil recovery solvers &mdash; The Matlab Reservoir Simulation Toolbox 2019b documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ad-mechanics: Coupled flow and mechanics" href="ad-mechanics.html" />
    <link rel="prev" title="ad-blackoil: Black-oil solvers" href="ad-blackoil.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> The Matlab Reservoir Simulation Toolbox
            <img src="_static/mrstlogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2019b
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-core.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-core</span></code>: Automatic Differentiation Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-props.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-props</span></code>: PVT, fluid models and other properties for the AD-solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ad-blackoil.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-blackoil</span></code>: Black-oil solvers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-eor</span></code>: Enhanced oil recovery solvers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ad_eor.models">Base classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-ad_eor.utils">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ad-mechanics.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-mechanics</span></code>: Coupled flow and mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="adjoint.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">adjoint</span></code>: Two-phase, incompressible adjoint solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="agglom.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">agglom</span></code>: Flow and property-based coarse-grid generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="blackoil-sequential.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">blackoil-sequential</span></code>: Sequential implicit black-oil solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="book.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">book</span></code>: Book examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="coarsegrid.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">coarsegrid</span></code>: Generation of coarse grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="compositional.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">compositional</span></code>: Equation-of-state compositional solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="co2lab.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">co2lab</span></code>: Numerical CO<sub>2</sub> laboratory</a></li>
<li class="toctree-l1"><a class="reference internal" href="deckformat.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">deckformat</span></code>: Reading and conversion of input decks</a></li>
<li class="toctree-l1"><a class="reference internal" href="dfm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dfm</span></code>: Discrete fracture matrix implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dg.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dg</span></code>: Discontinous Galerkin discretizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">diagnostics</span></code>: Flow diagnostics functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="dual_porosity.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dual-porosity</span></code>: Dual porosity/permeability model for fractures</a></li>
<li class="toctree-l1"><a class="reference internal" href="fvbiot.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">fvbiot</span></code>: Consistent finite-volume discretizations for poroelasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="geochemistry.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">geochemistry</span></code>: Surface geochemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="heterogeneity.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">heterogeneity</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="hfm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">hfm</span></code>: Hierarchical and embedded fractures</a></li>
<li class="toctree-l1"><a class="reference internal" href="incomp.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">incomp</span></code>: Solvers for incompressible flow and transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="libgeometry.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">libgeometry</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="linearsolvers.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">linearsolvers</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="matlab_bgl.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">matlab_bgl</span></code>:</a></li>
<li class="toctree-l1"><a class="reference internal" href="mimetic.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mimetic</span></code>: Mimetic solvers for pressure problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpfa.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mpfa</span></code>: Multi-point flux approximation solvers for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrst_api.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mrst_api</span></code>: API for writing C/C++ for MRST</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrst-gui.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">mrst-gui</span></code>: Graphical user-interfaces for MRST</a></li>
<li class="toctree-l1"><a class="reference internal" href="msfvm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msfvm</span></code>: Multiscale Finite-Volume method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="msmfem.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msmfem</span></code>: Multiscale Mixed Finite-Element method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="msrsb.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">msrsb</span></code>: Multiscale Restriction-Smoothed Basis method for pressure</a></li>
<li class="toctree-l1"><a class="reference internal" href="nwm.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">nwm</span></code>: Near Wellbore Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="opm_gridprocessing.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">opm_gridprocessing</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">optimization</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="re-mpfa.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">re-mpfa</span></code>: Richards’ equation with multi-point flux</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvent.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">solvent</span></code>: Solvent solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="spe10.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">spe10</span></code>: Access to the SPE10 benchmark case</a></li>
<li class="toctree-l1"><a class="reference internal" href="steady-state.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">steady-state</span></code> Steady-state upscaling of functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="streamlines.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">streamlines</span></code>: Compute streamlines</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangle.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">triangle</span></code>: Triangular grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="upscaling.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">upscaling</span></code>: Upscaling of reservoir problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="vem.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">vem</span></code>: Virtual element method on general grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="vemmech.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">vemmech</span></code>: Mechanics for general grids using the virtual element method</a></li>
<li class="toctree-l1"><a class="reference internal" href="wellpaths.html"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">wellpaths</span></code>: Generation of wells using general curves</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">The Matlab Reservoir Simulation Toolbox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-eor</span></code>: Enhanced oil recovery solvers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ad-eor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="ad-eor-enhanced-oil-recovery-solvers">
<h1><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ad-eor</span></code>: Enhanced oil recovery solvers<a class="headerlink" href="#ad-eor-enhanced-oil-recovery-solvers" title="Permalink to this headline"></a></h1>
<p>The ad-eor module extends the solvers found in ad-core and ad-blackoil with capability for simulating enhanced oil recovery (EOR). EOR is a category of recovery techniques that are characterized by the addition of different chemicals to improve the final recovery. Specifically, the module includes simulation of polymer with mixing rules, dead pore space, adsorption and velocity dependent viscosity, as well as surfactant.
ad</p>
<div class="section" id="models">
<h2>Models<a class="headerlink" href="#models" title="Permalink to this headline"></a></h2>
<div class="section" id="module-ad_eor.models">
<span id="base-classes"></span><h3>Base classes<a class="headerlink" href="#module-ad_eor.models" title="Permalink to this headline"></a></h3>
<dl class="mat script">
<dt class="sig sig-object mat" id="ad_eor.models.Contents">
<span class="sig-name descname"><span class="pre">Contents</span></span><a class="headerlink" href="#ad_eor.models.Contents" title="Permalink to this definition"></a></dt>
<dd><p>MODELS</p>
<dl class="simple">
<dt>Files</dt><dd><p>OilWaterPolymerModel              - Oil/water/polymer system
OilWaterSurfactantModel           - SYNOPSIS:
ThreePhaseBlackOilPolymerModel    - Three-phase black-oil model with support for polymer injection
ThreePhaseBlackOilSurfactantModel - SYNOPSIS:
ThreePhaseSurfactantPolymerModel  - Three-phase black-oil model with support for surfactant and polymer injection</p>
</dd>
</dl>
</dd></dl>

<dl class="mat class">
<dt class="sig sig-object mat" id="ad_eor.models.OilWaterPolymerModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">OilWaterPolymerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.OilWaterPolymerModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ad-blackoil.html#ad_blackoil.models.TwoPhaseOilWaterModel" title="ad_blackoil.models.TwoPhaseOilWaterModel"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">TwoPhaseOilWaterModel</span></code></a></p>
<p>Oil/water/polymer system</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="p">=</span> <span class="n">OilWaterPolymerModel</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">fluid</span><span class="p">,</span> <span class="n">varargin</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Two phase model with polymer. A description of the polymer model
that is implemented here can be found in the directory ad-eor/docs .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Grid</p></li>
<li><p><strong>rock</strong> – Rock structure</p></li>
<li><p><strong>fluid</strong> – Fluid structure</p></li>
<li><p><strong>varargin</strong> – optional parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>class instance</strong></p>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: ThreePhaseBlackOilPolymerModel</p>
<dl class="mat method">
<dt class="sig sig-object mat" id="ad_eor.models.OilWaterPolymerModel.addComponentContributions">
<span class="sig-name descname"><span class="pre">addComponentContributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">cname</span></em>, <em class="sig-param"><span class="pre">eq</span></em>, <em class="sig-param"><span class="pre">component</span></em>, <em class="sig-param"><span class="pre">src</span></em>, <em class="sig-param"><span class="pre">force</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.OilWaterPolymerModel.addComponentContributions" title="Permalink to this definition"></a></dt>
<dd><p>For a given component conservation equation, compute and add in
source terms for a specific source/bc where the fluxes have
already been computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – (Base class, automatic)</p></li>
<li><p><strong>cname</strong> – Name of the component. Must be a property known to the
model itself through <code class="xref mat mat-func docutils literal notranslate"><span class="pre">getProp</span></code> and <code class="xref mat mat-func docutils literal notranslate"><span class="pre">getVariableField</span></code>.</p></li>
<li><p><strong>eq</strong> – Equation where the source terms are to be added. Should
be one value per cell in the simulation grid (model.G)
so that the src.sourceCells is meaningful.</p></li>
<li><p><strong>component</strong> – Cell-wise values of the component in question. Used
for outflow source terms only.</p></li>
<li><p><strong>src</strong> – Source struct containing fields for fluxes etc. Should
be constructed from force and the current reservoir
state by <a class="reference internal" href="ad-core.html#ad_core.utils.computeSourcesAndBoundaryConditionsAD" title="ad_core.utils.computeSourcesAndBoundaryConditionsAD"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">computeSourcesAndBoundaryConditionsAD</span></code></a>.</p></li>
<li><p><strong>force</strong> – Force struct used to produce src. Should contain the
field defining the component in question, so that the
inflow of the component through the boundary condition
or source terms can accurately by estimated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat method">
<dt class="sig sig-object mat" id="ad_eor.models.OilWaterPolymerModel.getVariableField">
<span class="sig-name descname"><span class="pre">getVariableField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.OilWaterPolymerModel.getVariableField" title="Permalink to this definition"></a></dt>
<dd><p>Get the index/name mapping for the model (such as where
pressure or water saturation is located in state)</p>
</dd></dl>

</dd></dl>

<dl class="mat class">
<dt class="sig sig-object mat" id="ad_eor.models.OilWaterSurfactantModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">OilWaterSurfactantModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.OilWaterSurfactantModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel" title="ad_eor.models.ThreePhaseSurfactantPolymerModel"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">ThreePhaseSurfactantPolymerModel</span></code></a></p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="p">=</span> <span class="n">OilWaterSurfactantModel</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">fluid</span><span class="p">,</span> <span class="n">varargin</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Fully implicit model for an oil water system with surfactant. All
the equations are solved implicitly. A description of the surfactant model
that is implemented can be found in the directory ad-eor/docs .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Grid</p></li>
<li><p><strong>rock</strong> – Rock structure</p></li>
<li><p><strong>fluid</strong> – Fluid structure</p></li>
<li><p><strong>varargin</strong> – optional parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>class instance</strong></p>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: equationsOilWaterSurfactant,</p>
</dd></dl>

<dl class="mat class">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseBlackOilPolymerModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">ThreePhaseBlackOilPolymerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.ThreePhaseBlackOilPolymerModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ad-blackoil.html#ad_blackoil.models.ThreePhaseBlackOilModel" title="ad_blackoil.models.ThreePhaseBlackOilModel"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">ThreePhaseBlackOilModel</span></code></a></p>
<p>Three-phase black-oil model with support for polymer injection</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="p">=</span> <span class="n">ThreePhaseBlackOilPolymerModel</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">fluid</span><span class="p">,</span> <span class="n">varargin</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Fully implicit three phase blackoil model with polymer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Grid</p></li>
<li><p><strong>rock</strong> – Rock structure</p></li>
<li><p><strong>fluid</strong> – Fluid structure</p></li>
<li><p><strong>varargin</strong> – optional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>class instance</strong></p>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO:  equationsThreePhaseBlackOilPolymer, OilWaterPolymerModel</p>
<dl class="mat method">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseBlackOilPolymerModel.addComponentContributions">
<span class="sig-name descname"><span class="pre">addComponentContributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">cname</span></em>, <em class="sig-param"><span class="pre">eq</span></em>, <em class="sig-param"><span class="pre">component</span></em>, <em class="sig-param"><span class="pre">src</span></em>, <em class="sig-param"><span class="pre">force</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.ThreePhaseBlackOilPolymerModel.addComponentContributions" title="Permalink to this definition"></a></dt>
<dd><p>For a given component conservation equation, compute and add in
source terms for a specific source/bc where the fluxes have
already been computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – (Base class, automatic)</p></li>
<li><p><strong>cname</strong> – Name of the component. Must be a property known to the
model itself through <code class="xref mat mat-func docutils literal notranslate"><span class="pre">getProp</span></code> and <code class="xref mat mat-func docutils literal notranslate"><span class="pre">getVariableField</span></code>.</p></li>
<li><p><strong>eq</strong> – Equation where the source terms are to be added. Should
be one value per cell in the simulation grid (model.G)
so that the src.sourceCells is meaningful.</p></li>
<li><p><strong>component</strong> – Cell-wise values of the component in question. Used
for outflow source terms only.</p></li>
<li><p><strong>src</strong> – Source struct containing fields for fluxes etc. Should
be constructed from force and the current reservoir
state by <a class="reference internal" href="ad-core.html#ad_core.utils.computeSourcesAndBoundaryConditionsAD" title="ad_core.utils.computeSourcesAndBoundaryConditionsAD"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">computeSourcesAndBoundaryConditionsAD</span></code></a>.</p></li>
<li><p><strong>force</strong> – Force struct used to produce src. Should contain the
field defining the component in question, so that the
inflow of the component through the boundary condition
or source terms can accurately by estimated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat method">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseBlackOilPolymerModel.getVariableField">
<span class="sig-name descname"><span class="pre">getVariableField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.ThreePhaseBlackOilPolymerModel.getVariableField" title="Permalink to this definition"></a></dt>
<dd><p>Get the index/name mapping for the model (such as where
pressure or water saturation is located in state)</p>
</dd></dl>

<dl class="mat attribute">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseBlackOilPolymerModel.polymer">
<span class="sig-name descname"><span class="pre">polymer</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#ad_eor.models.ThreePhaseBlackOilPolymerModel.polymer" title="Permalink to this definition"></a></dt>
<dd><p>Using PLYSHEAR shear model based on water velocity</p>
</dd></dl>

<dl class="mat attribute">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseBlackOilPolymerModel.usingShear">
<span class="sig-name descname"><span class="pre">usingShear</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#ad_eor.models.ThreePhaseBlackOilPolymerModel.usingShear" title="Permalink to this definition"></a></dt>
<dd><p>Using PLYSHLOG shear model based on water velocity</p>
</dd></dl>

<dl class="mat attribute">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseBlackOilPolymerModel.usingShearLog">
<span class="sig-name descname"><span class="pre">usingShearLog</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#ad_eor.models.ThreePhaseBlackOilPolymerModel.usingShearLog" title="Permalink to this definition"></a></dt>
<dd><p>Using PLYSHLOG shear model base on water shear rate</p>
</dd></dl>

</dd></dl>

<dl class="mat class">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseBlackOilSurfactantModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">ThreePhaseBlackOilSurfactantModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.ThreePhaseBlackOilSurfactantModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel" title="ad_eor.models.ThreePhaseSurfactantPolymerModel"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">ThreePhaseSurfactantPolymerModel</span></code></a></p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="p">=</span> <span class="n">ThreePhaseBlackOilSurfactantModel</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">fluid</span><span class="p">,</span> <span class="n">varargin</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Fully implicit model for an black-oil system with surfactant. All
the equations are solved implicitly. A description of the surfactant model
that is implemented can be found in the directory ad-eor/docs .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Grid</p></li>
<li><p><strong>rock</strong> – Rock structure</p></li>
<li><p><strong>fluid</strong> – Fluid structure</p></li>
<li><p><strong>varargin</strong> – optional parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>class instance</strong></p>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: equationsThreePhaseBlackOilPolymer</p>
</dd></dl>

<dl class="mat class">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseSurfactantPolymerModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">ThreePhaseSurfactantPolymerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">rock</span></em>, <em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ad-blackoil.html#ad_blackoil.models.ThreePhaseBlackOilModel" title="ad_blackoil.models.ThreePhaseBlackOilModel"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">ThreePhaseBlackOilModel</span></code></a></p>
<p>Three-phase black-oil model with support for surfactant and polymer injection</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="p">=</span> <span class="n">ThreePhaseSurfactantPolymerModel</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">rock</span><span class="p">,</span> <span class="n">fluid</span><span class="p">,</span> <span class="n">varargin</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Fully implicit three phase blackoil model with polymer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Grid</p></li>
<li><p><strong>rock</strong> – Rock structure</p></li>
<li><p><strong>fluid</strong> – Fluid structure</p></li>
<li><p><strong>varargin</strong> – optional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>class instance</strong></p>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO:  equationsThreePhaseBlackOilPolymer, OilWaterPolymerModel</p>
<dl class="mat method">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseSurfactantPolymerModel.addComponentContributions">
<span class="sig-name descname"><span class="pre">addComponentContributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">cname</span></em>, <em class="sig-param"><span class="pre">eq</span></em>, <em class="sig-param"><span class="pre">component</span></em>, <em class="sig-param"><span class="pre">src</span></em>, <em class="sig-param"><span class="pre">force</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel.addComponentContributions" title="Permalink to this definition"></a></dt>
<dd><p>For a given component conservation equation, compute and add in
source terms for a specific source/bc where the fluxes have
already been computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – (Base class, automatic)</p></li>
<li><p><strong>cname</strong> – Name of the component. Must be a property known to the
model itself through <code class="xref mat mat-func docutils literal notranslate"><span class="pre">getProp</span></code> and <code class="xref mat mat-func docutils literal notranslate"><span class="pre">getVariableField</span></code>.</p></li>
<li><p><strong>eq</strong> – Equation where the source terms are to be added. Should
be one value per cell in the simulation grid (model.G)
so that the src.sourceCells is meaningful.</p></li>
<li><p><strong>component</strong> – Cell-wise values of the component in question. Used
for outflow source terms only.</p></li>
<li><p><strong>src</strong> – Source struct containing fields for fluxes etc. Should
be constructed from force and the current reservoir
state by <a class="reference internal" href="ad-core.html#ad_core.utils.computeSourcesAndBoundaryConditionsAD" title="ad_core.utils.computeSourcesAndBoundaryConditionsAD"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">computeSourcesAndBoundaryConditionsAD</span></code></a>.</p></li>
<li><p><strong>force</strong> – Force struct used to produce src. Should contain the
field defining the component in question, so that the
inflow of the component through the boundary condition
or source terms can accurately by estimated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat method">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseSurfactantPolymerModel.getVariableField">
<span class="sig-name descname"><span class="pre">getVariableField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel.getVariableField" title="Permalink to this definition"></a></dt>
<dd><p>Get the index/name mapping for the model (such as where
pressure or water saturation is located in state)</p>
</dd></dl>

<dl class="mat attribute">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseSurfactantPolymerModel.polymer">
<span class="sig-name descname"><span class="pre">polymer</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel.polymer" title="Permalink to this definition"></a></dt>
<dd><p>Using PLYSHEAR shear model based on water velocity</p>
</dd></dl>

<dl class="mat attribute">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseSurfactantPolymerModel.usingShear">
<span class="sig-name descname"><span class="pre">usingShear</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel.usingShear" title="Permalink to this definition"></a></dt>
<dd><p>Using PLYSHLOG shear model based on water velocity</p>
</dd></dl>

<dl class="mat attribute">
<dt class="sig sig-object mat" id="ad_eor.models.ThreePhaseSurfactantPolymerModel.usingShearLog">
<span class="sig-name descname"><span class="pre">usingShearLog</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#ad_eor.models.ThreePhaseSurfactantPolymerModel.usingShearLog" title="Permalink to this definition"></a></dt>
<dd><p>Using PLYSHLOG shear model based on water shear rate</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-ad_eor.utils">
<span id="utilities"></span><h2>Utilities<a class="headerlink" href="#module-ad_eor.utils" title="Permalink to this headline"></a></h2>
<dl class="mat script">
<dt class="sig sig-object mat" id="ad_eor.utils.Contents">
<span class="sig-name descname"><span class="pre">Contents</span></span><a class="headerlink" href="#ad_eor.utils.Contents" title="Permalink to this definition"></a></dt>
<dd><p>UTILS</p>
<dl class="simple">
<dt>Files</dt><dd><p>addPolymerProperties                            - Undocumented Utility Function
computeCapillaryNumber                          - SYNOPSIS:
computeFluxAndPropsOilWaterSurfactant           - SYNOPSIS:
computeFluxAndPropsThreePhaseBlackOilSurfactant - SYNOPSIS:
computeRelPermSft                               - SYNOPSIS:
computeSqVelocTPFA                              - SYNOPSIS:
computeVelocTPFA                                - SYNOPSIS:
equationsOilWaterPolymer                        - SYNOPSIS:
equationsOilWaterSurfactant                     - SYNOPSIS:
equationsThreePhaseBlackOilPolymer              - SYNOPSIS:
equationsThreePhaseBlackOilSurfactant           - SYNOPSIS:
equationsThreePhaseSurfactantPolymer            - SYNOPSIS:
getFluxAndPropsWaterPolymer_BO                  - dpW, extraOutput
updateAdsorption                                - SYNOPSIS:</p>
</dd>
</dl>
</dd></dl>

<dl class="mat script">
<dt class="sig sig-object mat" id="ad_eor.utils.equationsThreePhaseBlackOilSurfactant">
<span class="sig-name descname"><span class="pre">equationsThreePhaseBlackOilSurfactant</span></span><a class="headerlink" href="#ad_eor.utils.equationsThreePhaseBlackOilSurfactant" title="Permalink to this definition"></a></dt>
<dd><p>…</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.addPolymerProperties">
<span class="sig-name descname"><span class="pre">addPolymerProperties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fluid</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.addPolymerProperties" title="Permalink to this definition"></a></dt>
<dd><p>Undocumented Utility Function</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.applyShearEffects">
<span class="sig-name descname"><span class="pre">applyShearEffects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">v</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.applyShearEffects" title="Permalink to this definition"></a></dt>
<dd><p>Undocumented Utility Function</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.applyShearEffectsWell">
<span class="sig-name descname"><span class="pre">applyShearEffectsWell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">mob</span></em>, <em class="sig-param"><span class="pre">q_ph</span></em>, <em class="sig-param"><span class="pre">prop</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.applyShearEffectsWell" title="Permalink to this definition"></a></dt>
<dd><p>Undocumented Utility Function</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.computeSqVelocTPFA">
<span class="sig-name descname"><span class="pre">computeSqVelocTPFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">intInx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.computeSqVelocTPFA" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>sqVeloc<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">computeSqVelocTPFA</span><span class="p">(</span>G, intInx<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>DESCRIPTION: Setup the operator which computes an approximation of the square
of the velocity for each cell given fluxes on the faces. The following
method is used</p>
<p>1) For each face, we compute a square velocity by taking the square of the
flux after having divided it by the area. We obtain a scalar-valued variable
per face</p>
<p>2) From a scalar variable, a vector can be reconstructed on each face, using
the coordinate of the vector joining the cell centroid to the face
centroid. Let c denotes this vector, after renormalization, (example:
c=[1;0;0]’ for a face of a Cartesian 3D grid) then, from a scalar value f on
the face, we construct the vector-valued variable given by f*c.</p>
<p>3) We use the reconstruction defined in 2) to construct vector-valued
square velocity from the scalar-valued square velocity defined in 1).</p>
<p>4) We take the average of the vector-valued obtained in 3) . We use a
weight in the average so that faces that are far from the cell centroid
contribute less than those that are close. See implementation for how this
is done.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Grid structure</p></li>
<li><p><strong>intInx</strong> – Logical vector giving the internal faces.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sqVeloc</strong> – Function of the form u=sqVeloc(v), which returns cell-valued</p></li>
<li><p><strong>square of the velocity for given face</strong> – valued fluxes v.</p></li>
</ul>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: computeVelocTPFA</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.computeVelocTPFA">
<span class="sig-name descname"><span class="pre">computeVelocTPFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">G</span></em>, <em class="sig-param"><span class="pre">intInx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.computeVelocTPFA" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>veloc<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">computeVelocTPFA</span><span class="p">(</span>G, intInx<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Setup the operator which computes an approximation of the square
of the velocity for each cell given fluxes on the faces.</p>
<p>We use a velocity reconstruction of the type  v_c  = 1/V * sum_{f} (x_f -x_c)u_f
where</p>
<blockquote>
<div><p>v_c : Approximated alue of the velocity at the cell center
V   : Cell volume
f   : Face
x_f : Centroid of the face f
x_c : Centroid of the cell
u_f : flux at the face f</p>
</div></blockquote>
<p>Such reconstruction is exact for linear functions and first order accurate,
when a mimetic discretization is used or, in the case of TPFA, if the grid is
K-orthogonal. Note that it gives very large errors for cells that contain
well, as the pressure in such cells is only badly approximated by linear
functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – Grid structure</p></li>
<li><p><strong>intInx</strong> – Logical vector giving the internal faces.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sqVeloc</strong> – Function of the form u=sqVeloc(v), which returns cell-valued</p></li>
<li><p><strong>square of the velocity for given face</strong> – valued fluxes v.</p></li>
</ul>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: computeSqVelocTPFA</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.equationsOilWaterPolymer">
<span class="sig-name descname"><span class="pre">equationsOilWaterPolymer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state0</span></em>, <em class="sig-param"><span class="pre">state</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">dt</span></em>, <em class="sig-param"><span class="pre">drivingForces</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.equationsOilWaterPolymer" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[problem, state] = equationsOilWaterPolymer</span><span class="p">(</span>state0, state, model, dt, drivingForces, varargin<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Assemble the linearized equations for an oil-water-polymer
system, computing both the residuals and the Jacobians. Returns the result as
an instance of the class LinearizedProblem which can be solved using instances
of LinearSolverAD.</p>
<p>A description of the modeling equations can be found in the directory
ad-eor/docs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state0</strong> – State at previous times-step</p></li>
<li><p><strong>state</strong> – State at current time-step</p></li>
<li><p><strong>model</strong> – Model instance</p></li>
<li><p><strong>dt</strong> – time-step</p></li>
<li><p><strong>drivingForces</strong> – Driving forces (boundary conditions, wells, …)</p></li>
<li><p><strong>varargin</strong> – optional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>problem</strong> – Instance of LinearizedProblem</p></li>
<li><p><strong>state</strong> – Updated state variable (fluxes, mobilities and more can be
stored, the wellSol structure is also updated in case of control switching)</p></li>
</ul>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: LinearizedProblem, LinearSolverAD, equationsOilWater, OilWaterPolymerModel</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.equationsOilWaterSurfactant">
<span class="sig-name descname"><span class="pre">equationsOilWaterSurfactant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state0</span></em>, <em class="sig-param"><span class="pre">state</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">dt</span></em>, <em class="sig-param"><span class="pre">drivingForces</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.equationsOilWaterSurfactant" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[problem, state] = equationsOilWaterSurfactant</span><span class="p">(</span>state0, state, model, dt, drivingForces, varargin<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Assemble the linearized equations for an oil-water-surfactant
system, computing both the residuals and the Jacobians. Returns the result as
an instance of the class LinearizedProblem which can be solved using instances
of LinearSolverAD.</p>
<p>A description of the modeling equations can be found in the directory
ad-eor/docs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state0</strong> – State at previous times-step</p></li>
<li><p><strong>state</strong> – State at current time-step</p></li>
<li><p><strong>model</strong> – Model instance</p></li>
<li><p><strong>dt</strong> – time-step</p></li>
<li><p><strong>drivingForces</strong> – Driving forces (boundary conditions, wells, …)</p></li>
<li><p><strong>varargin</strong> – optional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>problem</strong> – Instance of LinearizedProblem</p></li>
<li><p><strong>state</strong> – Updated state variable (fluxes, mobilities and more can be
stored, the wellSol structure is also updated in case of control switching)</p></li>
</ul>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: LinearizedProblem, LinearSolverAD</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.equationsThreePhaseBlackOilPolymer">
<span class="sig-name descname"><span class="pre">equationsThreePhaseBlackOilPolymer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state0</span></em>, <em class="sig-param"><span class="pre">state</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">dt</span></em>, <em class="sig-param"><span class="pre">drivingForces</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.equationsThreePhaseBlackOilPolymer" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[problem, state] = equationsThreePhaseBlackOilPolymer</span><span class="p">(</span>state0, state, model, dt, drivingForces, varargin<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Assemble the linearized equations for a blackoil system,
computing both the residuals and the Jacobians. Returns the result as an
instance of the class LinearizedProblem which can be solved using instances of
LinearSolverAD.</p>
<p>A description of the modeling equations can be found in the directory
ad-eor/docs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state0</strong> – State at previous times-step</p></li>
<li><p><strong>state</strong> – State at current time-step</p></li>
<li><p><strong>model</strong> – Model instance</p></li>
<li><p><strong>dt</strong> – time-step</p></li>
<li><p><strong>drivingForces</strong> – Driving forces (boundary conditions, wells, …)</p></li>
<li><p><strong>varargin</strong> – optional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>problem</strong> – Instance of LinearizedProblem</p></li>
<li><p><strong>state</strong> – Updated state variable (fluxes, mobilities and more can be
stored, the wellSol structure is also updated in case of control switching)</p></li>
</ul>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: LinearizedProblem, LinearSolverAD, equationsOilWater, OilWaterPolymerModel</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.equationsThreePhaseSurfactantPolymer">
<span class="sig-name descname"><span class="pre">equationsThreePhaseSurfactantPolymer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state0</span></em>, <em class="sig-param"><span class="pre">state</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">dt</span></em>, <em class="sig-param"><span class="pre">drivingForces</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.equationsThreePhaseSurfactantPolymer" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[problem, state] = equationsThreePhaseSurfactantPolymer</span><span class="p">(</span>state0, state, model, dt, drivingForces, varargin<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Assemble the linearized equations for a blackoil surfactant-polymer system,
computing both the residuals and the Jacobians. Returns the result as
an instance of the class LinearizedProblem which can be solved using
instances of LinearSolverAD.</p>
<p>A description of the modeling equations can be found in the directory
ad-eor/docs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state0</strong> – State at previous times-step</p></li>
<li><p><strong>state</strong> – State at current time-step</p></li>
<li><p><strong>model</strong> – Model instance</p></li>
<li><p><strong>dt</strong> – time-step</p></li>
<li><p><strong>drivingForces</strong> – Driving forces (boundary conditions, wells, …)</p></li>
<li><p><strong>varargin</strong> – optional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>problem</strong> – Instance of LinearizedProblem</p></li>
<li><p><strong>state</strong> – Updated state variable (fluxes, mobilities and more can be
stored, the wellSol structure is also updated in case of control switching)</p></li>
</ul>
</dd>
</dl>
<p>EXAMPLE:</p>
<p>SEE ALSO: LinearizedProblem, LinearSolverAD, OilWaterSurfactantModel</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="ad_eor.utils.getFluxAndPropsWaterPolymer_BO">
<span class="sig-name descname"><span class="pre">getFluxAndPropsWaterPolymer_BO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">pO</span></em>, <em class="sig-param"><span class="pre">sW</span></em>, <em class="sig-param"><span class="pre">cp</span></em>, <em class="sig-param"><span class="pre">ads</span></em>, <em class="sig-param"><span class="pre">krW</span></em>, <em class="sig-param"><span class="pre">T</span></em>, <em class="sig-param"><span class="pre">gdz</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ad_eor.utils.getFluxAndPropsWaterPolymer_BO" title="Permalink to this definition"></a></dt>
<dd><p>dpW, extraOutput</p>
<p class="rubric">Synopsis:</p>
<div class="highlight-octave notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">[vW, vP, bW, muWeffMult, mobW, mobP, rhoW, pW, upcw, a] = getFluxAndPropsWaterPolymer_BO</span><span class="p">(</span>model, pO, sW, c, ads, krW, T, gdz<span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p class="rubric">Description:</p>
<p>Given pressure, saturation and polymer concentration and some
other input variables, compute the fluxes and other properties, as listed
below. Used in the assembly of the blackoil equations with polymer.</p>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h2>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ad-blackoil.html" class="btn btn-neutral float-left" title="ad-blackoil: Black-oil solvers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ad-mechanics.html" class="btn btn-neutral float-right" title="ad-mechanics: Coupled flow and mechanics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, SINTEF Digital.
      <span class="lastupdated">Last updated on Sep 23, 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>